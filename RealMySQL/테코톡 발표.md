## MySQL 트랜잭션 격리 수준
### 계기
현재 프로젝트를 진행하면서, 많은 팀들이 RDBMS로 MySQL을 채택했다고 알고있다. 우리팀 또한 MySQL을 기술 스택으로 선정하였다. 이때 해당 기술에 대한 적절한 이해가 기반이되면, 더 의미있는 프로젝트를 진행할 수 있다고 생각했습니다. 중요한 개념중 하나인 트랜잭션 격리 수준에 대해 공유하면 좋겠다고 생각했고, 발표를 진행하게 되었습니다. 
### 목적
- 락과 트랜잭션의 차이점을 알 수 있다.
- 트랜잭션 격리 수준이 성능 및 일관성에 미치는 영향을 
### 대상
Transaction의 개념에 대해 알고 있는 사람
- ACID 특징

- commit, rollback

### 키워드
- InnoDB 
- 트랜잭션
- 락
- 동시성
- 데이터 일관성
- ACID(?)
- Undo log
- Read-Uncommited
- Read-Commited
- Repeatable-Read
- Serializable
- Dirty Read
- Unrepeatable - Read
- Phantom Read

### 격리수준이 왜 존재하는가?
### Transaction
[공식문서](https://dev.mysql.com/doc/refman/8.4/en/glossary.html)
Transactions are **atomic** units of work that can be **committed** or **rolled back**. When a transaction makes multiple changes to the database, either all the changes succeed when the transaction is committed, or all the changes are undone when the transaction is rolled back.

트랜잭션: 데이터베이스에서 실행되는 작업의 원자적 단위로, 커밋되거나 롤백될 수 있다. 

Transactions are protected (isolated) from each other while they are in progress; they cannot interfere with each other or see each other's uncommitted data. This isolation is achieved through the **locking** mechanism. Experienced users can adjust the **isolation level**, trading off less protection in favor of increased performance and **concurrency**, when they can be sure that the transactions really do not interfere with each other.

- 실행되고 있는 트랜잭션들은 서로에게 영향을 주지 않는다. 다른 트랜잭션의 커밋되지 않은 data를 방해할 수 없다. 이 격리는 locking 매커니즘을 통해 달성 된다. 사용자는 서로 다른 트랜잭션들이 영향을 주지 않는다는 것을 확신할때, 격리수준을 조정하여 성능과 동시성 향상을 위해 보호 수준을 낮출 수 있다. 

### Lock
- sharedLock
A kind of **lock** that allows other **transactions** to read the locked object, and to also acquire other shared locks on it, but not to write to it. The opposite of **exclusive lock**.

- exclusive lock

A kind of **lock** that prevents any other **transaction** from locking the same row. Depending on the transaction **isolation level**, this kind of lock might block other transactions from writing to the same row, or might also block other transactions from reading the same row. The default `InnoDB` isolation level, **REPEATABLE READ**, enables higher **concurrency** by allowing transactions to read rows that have exclusive locks, a technique known as **consistent read**.
### Isolation
[공식문서](https://dev.mysql.com/doc/refman/8.4/en/mysql-acid.html) 

The **isolation** aspect of the ACID model mainly involves `InnoDB` [transactions](https://dev.mysql.com/doc/refman/8.4/en/glossary.html#glos_transaction "transaction"), in particular the [isolation level](https://dev.mysql.com/doc/refman/8.4/en/glossary.html#glos_isolation_level "isolation level") that applies to each transaction.

동시에 실행되는 트랜잭션들이 서로에게 영향을 주지 않아야한다.

Transaction isolation is one of the foundations of database processing. Isolation is the I in the acronym [ACID](https://dev.mysql.com/doc/refman/8.0/en/glossary.html#glos_acid "ACID"); the isolation level is the setting that fine-tunes the balance between performance and reliability, consistency, and reproducibility of results when multiple transactions are making changes and performing queries at the same time.

- 트랜잭션 격리는 데이터베이스 처리의 기초중 하나이다. Isolation은 ACID의 I를 뜻한다. 
- 격리 수준은 여러 트랜잭션들이 동시에 변경을 만들거나 쿼리를 수행할 때, 성능과 안정성, 일관성 및 결과의 재현성 간의 균형을 fine-tuning(미세조정)하는 설정이다. 

InnoDB는 4가지의 트랜잭션 격리수준을 제공한다. 

### Read Uncommited
SELECT 문이 nonlocking 방식으로 수행된다. 하지만 가능한 최근 버전의 row를 사용될 수 있다. 
- 각 트랜잭션에서의 변경 내용이 COMMIT이나, ROLLBACK 여부에 상관없이 다른 트랜잭션에서 보인다. 
문제점
- 어떤 트랜잭션에서 처리한 작업이 완료되지 않았는데도 다른 트랜잭션에서 볼 수 있는 현상이 나타남(더티리드)
→ 다른 트랜잭션으로부터 영향을 받았다. 

- consistent read
A read operation that uses **snapshot** information to present query results based on a point in time, regardless of changes performed by other transactions running at the same time. If queried data has been changed by another transaction, the original data is reconstructed based on the contents of the **undo log**. This technique avoids some of the **locking** issues that can reduce **concurrency** by forcing transactions to wait for other transactions to finish.

With **REPEATABLE READ** **isolation level**, the snapshot is based on the time when the first read operation is performed. With **READ COMMITTED** isolation level, the snapshot is reset to the time of each consistent read operation.

Consistent read is the default mode in which `InnoDB` processes `SELECT` statements in **READ COMMITTED** and **REPEATABLE READ** isolation levels. Because a consistent read does not set any locks on the tables it accesses, other sessions are free to modify those tables while a consistent read is being performed on the table.